<html>
<script>
    window.addEventListener('message', async function (event) {
        /*     let data ={
                    identify: "标识",
                    data: "需要计算的表达式"
                }*/
        let backMessage = {}

        console.log("进行eval对象", event.data)
        if (event.data.identify == 'evalAWK') {
            //数据格式
            /*     let data ={
                         identify: "evalAWK",
                        data: {lines: '',func: ''}
        }*/
            const {lines,func} = event.data.data
            //方法载入内存
            eval(func)
            let strings = lines.split('\n');
            let strInfo={
                size: strings.length,
                originStr: lines
            };
            let result = [];
            strings.forEach((str,index)=>{
                result.push(handleString(str,index,strInfo))
            });
            //回送消息
            backMessage = {
                identify: 'awkResult',
                data: result
            }
        }
        //扩展

        event.source.window.postMessage(backMessage, event.origin);

    });
</script>
</html>